{
	"name": "SQL script 4",
	"properties": {
		"content": {
			"query": "Create external table [dbo].[extt1_5]\nWITH\n(\n\tLOCATION = 'Parquet/data.parquet',\n\tDATA_SOURCE = [synapsedata01_dl4synapsesea01_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat]\n)\nAS\nWITH \nraw_data AS (\n    SELECT *\n    FROM [dbo].[extt1_4] WHERE ivp_dt = 20240704\n),\nremoved_dup AS (\n    SELECT C.* \n    FROM (SELECT DISTINCT zkzfustorcd from raw_data) A\n    CROSS APPLY (SELECT TOP 1 * \n                FROM raw_data B\n                WHERE A.zkzfustorcd  = B.zkzfustorcd\n                ORDER by [TIMESTAMP] DESC) C\n),\nnew_data AS (\n    SELECT *\n        , CAST('2024-07-01 16:04:12' as date) as [ivp_created_date]\n        , CAST('2024-07-01 16:04:12' as datetime2) as [ivp_created_timestamp]\n        , 'CCBJI' as [ivp_created_co]\n        , 'IVP' as [ivp_created_by]\n        , 'IF' as [ivp_created_pgm_nm]\n        , CAST('2024-07-01 16:04:12' as date) as [ivp_updated_date]\n        , CAST('2024-07-01 16:04:12' as datetime2) as [ivp_updated_timestamp]\n        , 'CCBJI' as [ivp_updated_co]\n        , 'IVP' as [ivp_updated_by]\n        , 'IF' as [ivp_updated_pgm_nm]\n        , 'U' as [ivp_updated_cl]\n    FROM [removed_dup]\n),\nnew_data_set AS (\n    SELECT \n       new_data.[zkzfustorcd]\n      ,new_data.[zkzfssetkbn]\n      ,new_data.[zkzdcbukrs]\n      ,new_data.[zkzfdelotxt]\n      ,new_data.[zkzfdelotxk]\n      ,new_data.[zkzfdelotab]\n      ,new_data.[zkzcusstdat]\n      ,new_data.[zkzcuseddat]\n      ,new_data.[zkzorotflg]\n      ,new_data.[zkzorogrpcd]\n      ,new_data.[zkzcmodeflg]\n      ,new_data.[zkzemocoflg]\n      ,new_data.[zkzppaidkbn]\n      ,new_data.[zkzidcadkbn]\n      ,new_data.[zkzondcpflg]\n      ,new_data.[zkzppaemocd]\n      ,new_data.[zkztranskbn]\n      ,new_data.[zkztaxkbn]\n      ,new_data.[zkzcprgrpcd]\n      ,new_data.[zkzopcpgrcd]\n      ,new_data.[zkzkemonkbn]\n      ,new_data.[zkzfrpkbn]\n      ,new_data.[zkzproekbn]\n      ,new_data.[zkzpainukbn]\n      ,new_data.[zkzimcedflg]\n      ,new_data.[zkzarkunnr]\n      ,new_data.[zkzppkunnr]\n      ,new_data.[zkzidkunnr]\n      ,new_data.[zkzcmonsflg]\n      ,new_data.[zkzcmonscd]\n      ,new_data.[zkzarpayee]\n      ,new_data.[zkzarmgtkbn]\n      ,new_data.[zkzmoparbuk]\n      ,new_data.[zkzmopdebuk]\n      ,new_data.[zkzmopucbuk]\n      ,new_data.[zkzcoscbkbn]\n      ,new_data.[zkzsplodgrcd]\n      ,new_data.[zkzdiswerks]\n      ,new_data.[zkzdirprocd]\n      ,new_data.[zkzdibarocd]\n      ,new_data.[zkzditeamcd]\n      ,new_data.[zkzdirerocd]\n      ,new_data.[zkzgrpcd]\n      ,new_data.[zkzsmgtbuk]\n      ,new_data.[zkzsmgtwer]\n      ,new_data.[zkzsmgtrocd]\n      ,new_data.[zkzmopsakbn]\n      ,new_data.[zkzprsprt]\n      ,new_data.[zkzcomcakbn]\n      ,new_data.[zkzlacadttm]\n      ,new_data.[zkzlcocakbn]\n      ,new_data.[zkzlfsorkbn]\n      ,new_data.[zkzsclrrflg]\n      ,new_data.[zkzcmcorkbn]\n      ,new_data.[zkzmbcorkbn]\n      ,new_data.[zkzwinscd1]\n      ,new_data.[zkzwinscd2]\n      ,new_data.[zkzfvctkbn]\n      ,new_data.[zkzfacecd]\n      ,new_data.[zkzdecatkbn]\n      ,new_data.[zkzdecapcd]\n      ,new_data.[zkzdecalgo]\n      ,new_data.[ZADMINDEL]\n      ,new_data.[ZCOMMTYP]\n      ,new_data.[ZAPCOMCC]\n      ,new_data.[ZCOMCC]\n      ,new_data.[ZSETSDATE]\n      ,new_data.[ZSETEDATE]\n      ,new_data.[ZUNIFRM]\n      ,new_data.[ZKZONLINEFLG] as [zkzonlineflg]\n      ,new_data.[ZKZDPFLG] as [zkzdpflg]\n      ,new_data.[zzernam]\n      ,new_data.[zzersda]\n      ,new_data.[zzerzzt]\n      ,new_data.[zzaenam]\n      ,new_data.[zzupdat]\n      ,new_data.[zzuptim]\n      ,new_data.[zzupind]\n      ,new_data.[ZZLOEVM]\n      ,new_data.[TIMESTAMP]\n    ,new_data.[ivp_dt],\n       new_data.[ivp_updated_date],\n       new_data.[ivp_updated_timestamp],\n       new_data.[ivp_updated_co],\n       new_data.[ivp_updated_by],\n       new_data.[ivp_updated_pgm_nm]\n    FROM new_data\n)\nselect * from new_data_set;\n\nselect * from [dbo].[extt1_5]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "db01",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}